# 程序创建多个线程合适

##### 1. CPU 密集型程序创建多少个线程合适
理论上设置 
```
线程数量 = CPU 核数（逻辑）
```
但是实际上，数量一般会设置为 
```
线程数量 = CPU 核数（逻辑）+ 1
```
因为计算(CPU)密集型的线程恰好在某时因为发生一个页错误或者因其他原因而暂停，刚好有一个“额外”的线程，可以确保在这种情况下CPU周期不会中断工作。所以对于CPU密集型程序，  `CPU 核数（逻辑）+ 1` 个线程数是比较好的经验值的原因了

##### 2. I/O密集型程序创建多少个线程合适
对于 I/O 密集型程序：
```
最佳线程数 =  (1/CPU利用率) = 1 + (I/O耗时/CPU耗时)
```
如果多个核心，那么 I/O 密集型程序的最佳线程数就是：
```
最佳线程数 = CPU核心数 *  (1/CPU利用率) =  CPU核心数 * (1 + (I/O耗时/CPU耗时))
```

参考：https://mp.weixin.qq.com/s/TTxKi2_x2vyH6EiqgSLoIg

